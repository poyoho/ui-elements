var e=Object.defineProperty,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(t,o,s)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,a=(e,a)=>{for(var r in a||(a={}))o.call(a,r)&&n(e,r,a[r]);if(t)for(var r of t(a))s.call(a,r)&&n(e,r,a[r]);return e};import{_ as r}from"./preload-helper.f6ac322f.js";import{c as i,a as c,t as l}from"./promise.2d7cfcc9.js";import{R as d,w as p,l as u}from"./vendor.3da8fb95.js";import{d as m}from"./debounce.cf38708f.js";const f=new URL("./token/onigasm.wasm",{}.url),h=i((()=>u(f.href)));async function w(e,t){await h();const o=new d({getGrammarDefinition:async e=>({"source.ts":{format:"json",content:(await r((()=>import("./TypeScript.tmLanguage.cc221230.js")),[])).default},"source.js":{format:"json",content:(await r((()=>import("./JavaScript.tmLanguage.043c95b7.js")),[])).default},"source.css":{format:"json",content:(await r((()=>import("./css.tmGrammar.d032072c.js")),[])).default},"source.vuehtml":{format:"json",content:(await r((()=>import("./vuehtml.tmLanguage.03554dcf.js")),[])).default}}[e])}),s=new Map;s.set("css","source.css"),s.set("typescript","source.ts"),s.set("javascript","source.js"),s.set("vuehtml","source.vuehtml"),e.editor.defineTheme("vscode-dark",function(e){let t=[],o={inherit:!0,base:"vs-dark",colors:e.colors,rules:t,encodedTokensColors:[]};return e.include&&console.log(e.include),e.tokenColors.map((function(e){if("string"==typeof e.scope){let s=e.scope.split(",");return s.length>1?(e.scope=s,void o()):void t.push(Object.assign({},e.settings,{token:e.scope}))}function o(){e.scope&&e.scope.map((function(o){t.push(Object.assign({},e.settings,{token:o}))}))}o()})),o}((await r((()=>import("./dark_vs.f3093edc.js")),[])).default)),await p(e,o,s,t)}function _(e){const t={noUnusedLocals:!1,noUnusedParameters:!1,allowUnreachableCode:!0,moduleResolution:2,allowUnusedLabels:!0,strict:!1,allowJs:!0,importHelpers:!0,noImplicitUseStrict:!1};e.languages.typescript.typescriptDefaults.setCompilerOptions(a(a({},e.languages.typescript.typescriptDefaults.getCompilerOptions()),t)),e.languages.typescript.javascriptDefaults.setCompilerOptions(a(a({},e.languages.typescript.javascriptDefaults.getCompilerOptions()),t));const o=new Set;return{hasDTS:e=>o.has(e),addDTS(t){t.forEach((e=>o.add(e.filePath))),e.languages.typescript.typescriptDefaults.setExtraLibs(t),e.languages.typescript.javascriptDefaults.setExtraLibs(t)},deleteDTS(t){const o=e.languages.typescript.typescriptDefaults.getExtraLibs();t.forEach((e=>{delete o[e]})),console.log(o)}}}const g=i((async()=>{if("undefined"!=typeof window){const e=new URL("/ui-elements/assets/loader.c0aae6e2.js",window.location),t=new URL("/ui-elements/assets/editor.main.a99b38ab.css",window.location),o=document.createElement("style");o.innerText=`@import "${t.href}";`;const s=document.createElement("script");return s.src=e.href,document.body.appendChild(s),new Promise((t=>{s.onload=async()=>{const s=e.href.replace("loader.js","");require.config({paths:{vs:s},"vs/css":{disabled:!0}}),require(["vs/editor/editor.main"],(e=>{t({monaco:e,style:o})}))}}))}throw"can not load moncao"})),y={vuehtml:"vuehtml",html:"html",js:"javascript",ts:"typescript",css:"css",json:"json"},j=i((async()=>{const[{},{default:e},{default:t},{default:o},{default:s},{default:n},{default:a}]=await Promise.all([r((()=>import("./monaco.contribution.c565256e.js")),["assets/monaco.contribution.c565256e.js","assets/preload-helper.f6ac322f.js"]),r((()=>import("./vuehtml.worker.5fce06f4.js")),[]),r((()=>import("./editor.worker.ff2bb489.js")),[]),r((()=>import("./json.worker.887c26be.js")),[]),r((()=>import("./ts.worker.18238e22.js")),[]),r((()=>import("./css.worker.8f3a2a08.js")),[]),r((()=>import("./html.worker.f9c5b6b7.js")),[])]);window.MonacoEnvironment={getWorker(r,i){switch(console.log("[load worker]",i),i){case"json":return new o;case"vuehtml":return new e;case"html":return new a;case"typescript":case"javascript":return new s;case"css":return new n;default:return new t}}}})),v=i((async()=>{const{monaco:e,style:t}=await g();return await j(),{monaco:e,style:t,typescript:_(e)}}));class E extends HTMLElement{constructor(){super(),this.monacoAccessor=v(),this.editor=c();const e=this.attachShadow({mode:"open"}),t=this.ownerDocument.createElement("div");t.style.width="inherit",t.style.height="inherit",t.innerHTML='<div id="editor-container" style="width:inherit;height:inherit;"></div>',e.appendChild(t)}get container(){return this.shadowRoot.querySelector("#editor-container")}async connectedCallback(){const{monaco:e,style:t}=await this.monacoAccessor,{container:o}=this;this.shadowRoot.appendChild(t.cloneNode(!0));const s=e.editor.create(o,{tabSize:2,insertSpaces:!0,autoClosingQuotes:"always",detectIndentation:!1,folding:!1,automaticLayout:!0,theme:"vscode-dark",minimap:{enabled:!1},useShadowDOM:!1});s.onDidChangeModel((()=>{const e=s.getModel();e&&(console.log("[monaco-editor] change model"),e.onDidChangeContent(m((async()=>{const e=document.createEvent("events");e.initEvent("code-change",!1,!1),e.value={content:s.getValue()},this.dispatchEvent(e)}))))})),this.editor.resolve(s),await w(e,s),e.editor.setTheme("vscode-dark")}disconnectedCallback(){}async createModel(e,t,o){console.log("[monaco-editor] createModel");const{monaco:s}=await this.monacoAccessor;return s.editor.createModel(o||"",y[e],s.Uri.file(`file://${t}`))}setModel(e){console.log("[monaco-editor] setModel"),this.editor.promise.then((t=>{t.setModel(e)}))}async findModel(e){const{monaco:t}=await this.monacoAccessor;return t.editor.getModel(t.Uri.file(`file://${e}`))}removeModel(){this.editor.promise.then((e=>{var t;null==(t=e.getModel())||t.dispose()}))}}async function b(e){const{monaco:t}=await v(),o=t.Uri.file(`file://${e}`),s=await l((()=>t.languages.typescript.getTypeScriptWorker()),3,100),n=await s(o),a=(await n.getEmitOutput(o.toString())).outputFiles.find((e=>e.name.endsWith(".js")));return a&&a.text||""}function D(){window.customElements.get("monaco-editor")||(window.MonacoEditor=E,window.customElements.define("monaco-editor",E))}export{E as MonacoEditor,b as getRunnableJS,D as install};
